! Title: HTTP_Restricted - Cross-Site Scripting and Hijacking Protection 
! Licence: Unlicense (https://choosealicense.com/licenses/unlicense/)
! Homepage: https://github.com/InnoScorpio/Public_Adblock_Filters
! Expires: 8 hours
! Version: 05.09.2020
! Source: 
! Issues: https://github.com/InnoScorpio/Public_Adblock_Filters
! Description:  This list includes rules to protect against some cross-site-scripting and hijacking attacks. This is meant to be used along with HTTP_Restricted lists for more secure browsing.
! Use them at your own risk.
! Attribution: LennyFox, Cybo1927
! ====================================================================================================================
! WebSockets are not restrained by the same-origin policy, an attacker can easily initiate a WebSocket request 
!(i.e. the handshake/upgrade process) from a malicious webpage targeting 
! the ws:// or wss:// endpoint URL of the attacked application.
! Websockets can be used to scan for open TCP ports as well from private network. Inspired by LennyFox.
! Guidance: https://www.christian-schneider.net/CrossSiteWebSocketHijacking, https://datatracker.ietf.org/meeting/96/materials/slides-96-saag-1/
ws://*$all
wss://*$all
||*$websocket
! Block connect-src directive on insecure HTTP websites.
||*^$csp=connect-src https:
! "If you run eval() with a string that could be affected by a malicious party, you may end up running malicious code on the user's
! machine with the permissions of your webpage/extension," Mozilla explains on its MDN web docs. 
! -https://thehackernews.com/2019/10/firefox-javascript-injection.html
*##+js(noeval)
! Block Javascript on HTTP websites.
||*^$csp=script-src https:
! Stop frames from being embedded on HTTP websites. Mitigates some clickjacking attacks.
||*^$csp=frame-ancestors 'none'
! Stop frames being loaded on HTTP websites.
||*^$csp=frame-src https:
! Stop plugins from loading on webpages on HTTP websites
||*^$csp=object-src https:
! Stop plugins from loading on HTTP websites
http://*$object
